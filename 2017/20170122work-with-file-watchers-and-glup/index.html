<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <title>使用File Watchers和Gulp打造便捷的前端自动化流程 | Moren&#39;s</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, maximum-scale=1">
    <link rel="apple-touch-icon" sizes="144x144" href="/favicon.png">
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.4.1/dist/gitalk.css" integrity="sha256-4uFBneYzpMnNUfY7h9Zeiw6uazKIWM9RGXSJqtl6Z/8=" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/style.css"> 
</head>

<body>
<main class="post">
    
<article>

    <nav class="navbar">
    <div class="layout">
        <div class="content">
            
            
            <a href="/.">Home</a>
            
            
            
            <a href="/archives">Archive</a>
            
            
            
            <a href="//yangteng.me">About</a>
            
            
        </div>
    </div>
 </nav>
    
    <div class="header-wrapper">
    
        <header class="article-header">
    
            <div class="placeholder"></div>
            <h1 class="article-title">
                <a href="/2017/20170122work-with-file-watchers-and-glup/">
                    使用File Watchers和Gulp打造便捷的前端自动化流程
                </a>
            </h1>

            <div class="article-meta">
                <p class="article-date">
                    Posted January 22 2017
                </p>
            
        </div></header>
    </div>

    <section class="article-entry">
        <p>和Grunt一样，Gulp也是当下很流行的一款前端自动化工具。Gulp自带的文件监视功能本身其实已经十分强大，但是搭配JetBrains全家桶时，快捷度不如JB自带的FileWatchers功能，而且会一直占用Terminal窗口。而JB自带的FileWatcher在功能上也有一些局限，例如不能像Gulp那样一次性完成一套很牛逼的文件处理。</p>
<p>所以如果我们开一下脑洞，让JetBrains中的FileWatchers功能主动监视文件变动，然后调用Gulp完成文件处理，这样的自动化流程会是多么的和谐美好。</p>
<p>##安装和配置Gulp</p>
<p>安装Gulp十分便捷。我们使用npm来安装Gulp。</p>
<p>首先，初始化一个npm项目：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm init</span><br></pre></td></tr></table></figure>
<p>然后，将Gulp作为项目的开发依赖安装(可能需要<code>sudo</code>）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install gulp --save-dev</span><br></pre></td></tr></table></figure>
<p>与Grunt使用<code>json</code>配置自动化流程不同，Gulp使用<code>js</code>来配置。在项目根目录下新建一个<code>gulpfile.js</code>文件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'default'</span>, <span class="function"><span class="keyword">function</span></span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Hello Gulp! '</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>这时候我们如果在终端中输入<code>gulp</code>，系统就会自动执行默认任务，这时候就可以看到屏幕上打印出的<code>Hello Gulp</code>了。</p>
<h4>自定义Gulp任务</h4>
<p>我们使用<code>gulp.task(task_name, function(){})</code>命令来注册一项Gulp任务，使用<code>gulp task_name</code>来执行一项任务。</p>
<p>这里我们以使用Gulp讲sass文件编译成css文件为例，首先我们要安装<code>gulp-sass</code>插件（可能需要<code>sudo</code>）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install gulp-sass --save-dev</span><br></pre></td></tr></table></figure>
<p>然后在配置文件中编写：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>),</span><br><span class="line">    sass = <span class="built_in">require</span>(<span class="string">'gulp-sass'</span>);</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'sass'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'./sass/**/*.scss'</span>)</span><br><span class="line">    .pipe(sass().on(<span class="string">'error'</span>, sass.logError))</span><br><span class="line">    .pipe(gulp.dest(<span class="string">'./css'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>这时候如果我们只需要在终端中输入<code>gulp sass</code>，Gulp就会自动将项目中的所有sass文件编译成css了。这里可以注意的是，如果只想要编译指定某个文件夹的某一级目录下的sass文件，在<code>gulp.src</code>中的参数应设置成<code>./sass/*.sass</code>，如果你想要递归地讲所有子目录中的文件也编译成sass，参数就应设置成<code>./sass/**/*.sass</code>。</p>
<p>如果要使用Gulp自带的文件监视器，可以再后面加上：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">'sass:watch'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  gulp.watch(<span class="string">'./sass/**/*.scss'</span>, [<span class="string">'sass'</span>]);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>这样你每次修改文件并保存的时候，系统就会自动帮你编译sass了。</p>
<h4>Gulp插件仓库</h4>
<p>如果你还想要更多的Gulp插件，可以到<a href="http://gulpjs.com/plugins/" target="_blank" rel="noopener">http://gulpjs.com/plugins/</a>中查找和下载。</p>
<h3>配置File Watchers</h3>
<p>File Watchers的配置就相对简单得多了。我们以自动监视所有sass文件并最终将app.sass编译成app.wxss为例。</p>
<p>我们先设置好Gulp的配置文件，这里我们要多使用一个<code>gulp-rename</code>的插件来帮助我们重命名文件。这里是配置文件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>),</span><br><span class="line">    sass = <span class="built_in">require</span>(<span class="string">'gulp-sass'</span>),</span><br><span class="line">    rename = <span class="built_in">require</span>(<span class="string">'gulp-rename'</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'sass'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'sass-watch'</span>);</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'./app.sass'</span>)</span><br><span class="line">        .pipe(sass(&#123;<span class="attr">outputStyle</span>: <span class="string">'compressed'</span>&#125;).on(<span class="string">'error'</span>, sass.logError))</span><br><span class="line">        .pipe(rename(&#123;<span class="attr">extname</span>: <span class="string">'.wxss'</span>&#125;))</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'./'</span>));</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>接着配置File Watcher。打开设置，找到FileWatchers选项卡，添加<code>sass</code>的监视器。在Program中，我们在选中入口文件<code>Gulp.js</code>，（Mac中默认存放在<code>/usr/local/bin</code>文件夹下，如果没有找到，先使用<code>npm install gulp -g</code>全局安装Gulp并记下安装位置）然后在Arguments中直接填入我们需要执行的任务，这里是<code>sass</code>，Output选项留空即可。保存设置，进入IDE中就可以看到Gulp为我们服务了。</p>
<h4>最后再多说几句</h4>
<p>其实使用Grunt也可以搭配FileWatchers进行同样的操作，配制方法也没有改变，如果有兴趣可以去尝试一下。</p>

    </section>
    
    <section class="article-comments">
        <div id="gitalk-container"></div>
    </section>
    
    <script src="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js" crossorigin="anonymous"></script>
    <script>
        var gitalk = new Gitalk({
            clientID: '6911ddf87e5838ca7da0',
            clientSecret: 'c8b78dec8b54f7009dbd6cce41d42d19eeb0f627',
            id: (window.location.pathname + '').substring(0,50),
            repo: 'blog',
            owner: 'morenyang',
            admin: 'morenyang',
            distractionFreeMode: false
        })
    
        gitalk.render('gitalk-container')
    </script>
</article>

</main>
<footer class="footer">
    <p>Powered by Moren YANG&nbsp;&nbsp;-&nbsp;&nbsp;ackn. <a href="https://hexo.io"> Hexo </a></p>
</footer>

</body>
</html>