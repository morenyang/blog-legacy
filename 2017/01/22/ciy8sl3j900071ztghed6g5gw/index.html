<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>使用File Watchers和Gulp打造便捷的前端自动化流程 | Moren&#39;s</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="shortcut icon" href="http://morensblog-static.tengtengtengteng.com/static/img/favicon.png">
    <link rel="stylesheet" href="/blog/css/style.css">
</head>

<body>
<nav class="navbar">
    <div class="layout">
        <div class="content ">
            
            
            <a href="/blog/.">Home</a>
            
            
            
            <a href="/blog/archives">Archive</a>
            
            
            
            <a href="http://yangteng.me">About</a>
            
            
        </div>
    </div>
</nav>

<main class="post">
    <article>
    <h1 class="article-title">
        <a href="/blog/2017/01/22/ciy8sl3j900071ztghed6g5gw/">使用File Watchers和Gulp打造便捷的前端自动化流程</a>
    </h1>

    <section class="article-meta">
        <p class="article-date">January 22 2017</p>
    </section>

    <section class="article-entry">
        <p>和Grunt一样，Gulp也是当下很流行的一款前端自动化工具。Gulp自带的文件监视功能本身其实已经十分强大，但是搭配JetBrains全家桶时，快捷度不如JB自带的FileWatchers功能，而且会一直占用Terminal窗口。而JB自带的FileWatcher在功能上也有一些局限，例如不能像Gulp那样一次性完成一套很牛逼的文件处理。</p>
<p>所以如果我们开一下脑洞，让JetBrains中的FileWatchers功能主动监视文件变动，然后调用Gulp完成文件处理，这样的自动化流程会是多么的和谐美好。</p>
<h2 id="安装和配置Gulp"><a href="#安装和配置Gulp" class="headerlink" title="安装和配置Gulp"></a>安装和配置Gulp</h2><p>安装Gulp十分便捷。我们使用npm来安装Gulp。</p>
<p>首先，初始化一个npm项目：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm init</div></pre></td></tr></table></figure>
<p>然后，将Gulp作为项目的开发依赖安装(可能需要<code>sudo</code>）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install gulp --save-dev</div></pre></td></tr></table></figure>
<p>与Grunt使用<code>json</code>配置自动化流程不同，Gulp使用<code>js</code>来配置。在项目根目录下新建一个<code>gulpfile.js</code>文件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'default'</span>, <span class="function"><span class="keyword">function</span></span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'Hello Gulp! '</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>这时候我们如果在终端中输入<code>gulp</code>，系统就会自动执行默认任务，这时候就可以看到屏幕上打印出的<code>Hello Gulp</code>了。</p>
<h4 id="自定义Gulp任务"><a href="#自定义Gulp任务" class="headerlink" title="自定义Gulp任务"></a>自定义Gulp任务</h4><p>我们使用<code>gulp.task(task_name, function(){})</code>命令来注册一项Gulp任务，使用<code>gulp task_name</code>来执行一项任务。</p>
<p>这里我们以使用Gulp讲sass文件编译成css文件为例，首先我们要安装<code>gulp-sass</code>插件（可能需要<code>sudo</code>）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install gulp-sass --save-dev</div></pre></td></tr></table></figure>
<p>然后在配置文件中编写：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>),</div><div class="line">    sass = <span class="built_in">require</span>(<span class="string">'gulp-sass'</span>);</div><div class="line">	</div><div class="line"></div><div class="line">gulp.task(<span class="string">'sass'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'./sass/**/*.scss'</span>)</div><div class="line">    .pipe(sass().on(<span class="string">'error'</span>, sass.logError))</div><div class="line">    .pipe(gulp.dest(<span class="string">'./css'</span>));</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>这时候如果我们只需要在终端中输入<code>gulp sass</code>，Gulp就会自动将项目中的所有sass文件编译成css了。这里可以注意的是，如果只想要编译指定某个文件夹的某一级目录下的sass文件，在<code>gulp.src</code>中的参数应设置成<code>./sass/*.sass</code>，如果你想要递归地讲所有子目录中的文件也编译成sass，参数就应设置成<code>./sass/**/*.sass</code>。</p>
<p>如果要使用Gulp自带的文件监视器，可以再后面加上：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">gulp.task(<span class="string">'sass:watch'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  gulp.watch(<span class="string">'./sass/**/*.scss'</span>, [<span class="string">'sass'</span>]);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>这样你每次修改文件并保存的时候，系统就会自动帮你编译sass了。</p>
<h4 id="Gulp插件仓库"><a href="#Gulp插件仓库" class="headerlink" title="Gulp插件仓库"></a>Gulp插件仓库</h4><p>如果你还想要更多的Gulp插件，可以到<a href="http://gulpjs.com/plugins/" target="_blank" rel="external">http://gulpjs.com/plugins/</a>中查找和下载。</p>
<h2 id="配置File-Watchers"><a href="#配置File-Watchers" class="headerlink" title="配置File Watchers"></a>配置File Watchers</h2><p>File Watchers的配置就相对简单得多了。我们以自动监视所有sass文件并最终将app.sass编译成app.wxss为例。</p>
<p>我们先设置好Gulp的配置文件，这里我们要多使用一个<code>gulp-rename</code>的插件来帮助我们重命名文件。这里是配置文件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>),</div><div class="line">    sass = <span class="built_in">require</span>(<span class="string">'gulp-sass'</span>),</div><div class="line">    rename = <span class="built_in">require</span>(<span class="string">'gulp-rename'</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'sass'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'sass-watch'</span>);</div><div class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'./app.sass'</span>)</div><div class="line">        .pipe(sass(&#123;outputStyle: <span class="string">'compressed'</span>&#125;).on(<span class="string">'error'</span>, sass.logError))</div><div class="line">        .pipe(rename(&#123;extname: <span class="string">'.wxss'</span>&#125;))</div><div class="line">        .pipe(gulp.dest(<span class="string">'./'</span>));</div><div class="line"></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>接着配置File Watcher。打开设置，找到FileWatchers选项卡，添加<code>sass</code>的监视器。在Program中，我们在选中入口文件<code>Gulp.js</code>，（Mac中默认存放在<code>/usr/local/bin</code>文件夹下，如果没有找到，先使用<code>npm install gulp -g</code>全局安装Gulp并记下安装位置）然后在Arguments中直接填入我们需要执行的任务，这里是<code>sass</code>，Output选项留空即可。保存设置，进入IDE中就可以看到Gulp为我们服务了。</p>
<h4 id="最后再多说几句"><a href="#最后再多说几句" class="headerlink" title="最后再多说几句"></a>最后再多说几句</h4><p>其实使用Grunt也可以搭配FileWatchers进行同样的操作，配制方法也没有改变，如果有兴趣可以去尝试一下。</p>

    </section>
</article>

</main>
<footer class="footer">
    <p>Powered by Moren YANG&nbsp;&nbsp;-&nbsp;&nbsp;ackn. <a href="https://hexo.io"> Hexo </a></p>
</footer>

</body>
</html>
